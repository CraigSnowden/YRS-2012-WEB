<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script src="./bootstrap/js/jquery.js"></script>
<style>
.pic a {color:inherit;text-decoration:none;}
a img  {border:none}
.pic {padding:5px 10px 5px 0px;}
</style>
<script>
var greatest_flickr_date=0;

function init(){
	ref();
	setInterval("ref();",1000*60);
}

function refFlickr(){
$.ajax({
   type: 'GET',
    url: 'http://api.flickr.com/services/feeds/photos_public.gne?tags=yrs2011&lang=en-us&format=json',
    async: false,
	jsonpCallback: 'jsonFlickrFeed',
	contentType: "application/json",
	dataType: 'jsonp',
	success: function(json) {
		console.log(json.items);
		for(var i=json.items.length-1;i>=0;--i) {
			console.log(json.items[i].created_at);
			var date = new Date(json.items[i].published);
			var mils = date.getTime();
			if(mils>greatest_flickr_date){
				greatest_flickr_date = mils;
				createPic(json.items[i]);
			}else console.log('old pic');
		}
    },
    error: function(e) {
		console.log(e.message);
    }
});
}

function createPic(pic){
	var picDiv = document.createElement('div');
	picDiv.className='pic';
	var picLink = document.createElement('a');
	picLink.href = pic.link;
	var picContent = document.createElement('img');
	picContent.src=pic.media.m;
	picContent.style.height='155px';
	picDiv.style.cssFloat='left';
	picLink.appendChild(picContent);
	picDiv.appendChild(picLink);
	$(picDiv).hide();//tweetDiv.style.display='none';
	console.log(pic.media.m);
	document.body.appendChild(picDiv);
	//alert(tweetDiv);
	$(picDiv).insertBefore(document.body.children[0]);
	$(picDiv).show(500);//tweetDiv.style.display='none';

}
</script>
</head>

<body onload="init();">
<div class="end">&nbsp;</div>
</body>
</html>
